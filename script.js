function initMobileMenu(){const a=document.querySelector('.hamburger'),b=document.querySelector('.nav-menu');a.addEventListener('click',()=>{a.classList.toggle('active');b.classList.toggle('active')});document.querySelectorAll('.nav-link').forEach(c=>{c.addEventListener('click',()=>{a.classList.remove('active');b.classList.remove('active')})})}function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener('click',function(b){b.preventDefault();const c=document.querySelector(this.getAttribute('href'));c&&c.scrollIntoView({behavior:'smooth',block:'start'});setTimeout(()=>{this.blur();document.activeElement.blur()},100)})})}function initHeaderScroll(){const a=document.querySelector('.header');window.addEventListener('scroll',()=>{a.style.background=window.scrollY>100?'rgba(255, 255, 255, 0.98)':'rgba(255, 255, 255, 0.95)'})}function initScrollAnimations(){const a=new IntersectionObserver(b=>{b.forEach(c=>{c.isIntersecting&&c.target.classList.add('animate-fade-in')})},{threshold:0.1,rootMargin:'0px 0px -50px 0px'});document.querySelectorAll('.section-header').forEach(b=>{a.observe(b)})}async function initWaveformAnimation(){const a=document.createElement('style');a.textContent='.hero-wave-bar{width:2px;background:rgba(255,255,255,0.9);border-radius:1px;transform-origin:bottom;transition:height 0.1s ease}';document.head.appendChild(a);await generateWaveformsFromAudio()}async function generateWaveformsFromAudio(){const a=document.querySelectorAll('.hero-play-btn');a.forEach(d=>{createFallbackWaveform(d)});let b=null;try{b=new(window.AudioContext||window.webkitAudioContext)();for(const d of a){const e=d.getAttribute('data-audio');if(!e)continue;try{const f=await fetch(e);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const g=await f.arrayBuffer(),h=await b.decodeAudioData(g),i=analyzeAudioBuffer(h),j=d.closest('.hero-audio-item').querySelector('.hero-waveform');createHeroWaveform(j,i,12)}catch(c){}}}catch(c){}finally{b&&b.state!=='closed'&&b.close()}}function analyzeAudioBuffer(a){const b=a.getChannelData(0),c=b.length,d=Math.floor(c/100),e=[];for(let f=0;f<100;f++){const g=f*d,h=g+d;let i=0;for(let j=g;j<h&&j<c;j++)i+=Math.abs(b[j]);e.push(i/d)}return e}function createHeroWaveform(a,b,c){const d=Math.floor(b.length/c);let e='';for(let f=0;f<c;f++){const g=Math.min(f*d,b.length-1),h=Math.max(10,Math.min(90,b[g]*1000));e+=`<div class="hero-wave-bar" style="height:${h}%"></div>`}a.innerHTML=e}function createFallbackWaveform(a){const b=a.closest('.hero-audio-item').querySelector('.hero-waveform'),c=a.getAttribute('data-audio'),d={'audio/kawaii.wav':[25,45,65,35,50,75,40,60,30,55,45,35],'audio/oneesan.wav':[40,60,45,70,55,35,65,50,75,45,55,40],'audio/fuwafuwa.wav':[30,50,40,55,45,60,35,65,50,40,45,30],'audio/prince.wav':[50,70,60,45,75,55,65,40,60,70,50,45]},e=d[c]||[40,50,60,45,55,65,50,45,55,60,50,45];let f='';e.forEach(g=>{f+=`<div class="hero-wave-bar" style="height:${g}%"></div>`});b.innerHTML=f}function initEmailCopy(){const a=document.getElementById('email-copy');a&&a.addEventListener('click',()=>{navigator.clipboard.writeText('aibyoneko@gmail.com').then(()=>{const b=a.textContent;a.textContent='コピー完了';setTimeout(()=>{a.textContent=b},480)}).catch(()=>{const b=document.createElement('textarea');b.value='aibyoneko@gmail.com';document.body.appendChild(b);b.select();document.execCommand('copy');document.body.removeChild(b);const c=a.textContent;a.textContent='コピー完了';setTimeout(()=>{a.textContent=c},2000)})})}function initLogoClick(){const a=document.getElementById('header-logo');a&&a.addEventListener('click',()=>{window.scrollTo({top:0,behavior:'smooth'})})}function showFormNotice(){const a=document.querySelector('.form-notice');a&&(a.style.display='block')}document.addEventListener('DOMContentLoaded',()=>{initMobileMenu();initSmoothScroll();initScrollAnimations();initWaveformAnimation();initHeaderScroll();initEmailCopy();initLogoClick();showFormNotice()});